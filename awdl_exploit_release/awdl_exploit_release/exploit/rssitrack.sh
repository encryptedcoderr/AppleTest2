#!/bin/bash

# Define the wireless interface and output file
INTERFACE="wlan0"  # Change this to your actual wireless interface
OUTPUT_FILE="strong_signals.txt"

# Clear the output file
> "$OUTPUT_FILE"

# Start airodump-ng on channel 44 with a custom filter
sudo airodump-ng --channel 44 --output-format csv -w /tmp/airodump_output "$INTERFACE" &

# Give airodump-ng some time to start up
sleep 5

# Monitor the output CSV file for RSSI values in the specified range
tail -f /tmp/airodump_output-01.csv | while IFS=',' read -r mac _ _ _ _ _ rssi _; do
    # Check if rssi is in dBm format
    if [[ $rssi =~ ^-?[0-9]+$ ]]; then
        if (( rssi >= -40 && rssi <= -30 )); then
            echo "MAC: $mac, RSSI: $rssi dBm" >> "$OUTPUT_FILE"
        fi
    fi
done

# Clean up when finished (optional, you might want to add a way to kill this script gracefully)
trap "pkill airodump-ng; rm /tmp/airodump_output-01.csv; exit" SIGINT