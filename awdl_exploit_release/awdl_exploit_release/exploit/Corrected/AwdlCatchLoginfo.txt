This script, with the updated MAC addresses and Apple's AWDL BSSID, should perform the following tasks:

Set WiFi Configuration:
It starts by setting the WiFi interface (wlan3 in this case) to channel 6. This is done by calling set_wifi_channel with channel 6 as an argument. If this fails, the script will exit with an error message.
Packet Capture Setup:
It opens a live capture session on the specified interface with pcap_open_live, preparing to capture packets with full buffering (BUFSIZ), in non-promiscuous mode (since promiscuity is set to 1), and with a timeout of 1000 milliseconds.
Filter Configuration:
A packet filter is set up to only capture packets where the MAC address de:2d:17:c3:52:32 (the TARGET_MAC) is involved either as the destination (addr1), source (addr2), or BSSID (addr3). This filter ensures that only packets related to this specific device are processed further.
AWDL Frame Detection:
The is_awdl_frame function checks if incoming packets are AWDL frames by examining:
The frame control type and subtype to ensure it's a management action frame.
The action frame's category to confirm it's vendor-specific.
The OUI (Organizationally Unique Identifier) matches the Apple AWDL BSSID 00:25:00:ff:94:73.
The frame type and version match AWDL standards.
Logging:
If a packet is identified as an AWDL frame, log_awdl_info writes detailed information to awdl_info.log:
Timestamp of when the frame was received.
Source and destination MAC addresses.
AWDL subtype, PHY TX, and Target TX timestamps.
Continuous Capture:
After setting up the filter, the script enters a loop (pcap_loop) where it continues to capture packets indefinitely (0 as the packet count argument means loop indefinitely) and calls log_awdl_info for each packet that matches the criteria.

Expected Behavior:
Capture and Log AWDL Frames: Specifically from or to the device with MAC de:2d:17:c3:52:32 on channel 6, that match the AWDL frame structure with the specified BSSID.
Error Handling: If there are issues with setting the channel, opening the interface for capture, or applying the packet filter, the script will exit with an error message.

Limitations:
The script assumes the target device is on channel 6; if it moves to another channel, the script would need to be manually updated or dynamically adjusted.
The script focuses on one specific MAC address; if you're looking to monitor multiple devices or a broader range of AWDL traffic, you'd need to adjust the filter or implement additional logic.

This setup is tailored for monitoring AWDL traffic from a specific Apple device, logging details when it communicates in a manner that matches AWDL standards.