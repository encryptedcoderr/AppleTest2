#!/bin/bash

# Variables
OUTPUT_FILE_BASE_1="airodump_output_1"
OUTPUT_FILE_BASE_2="airodump_output_2"
INTERFACE="wlan0"  # Change to your actual interface
DURATION=30        # Duration for each airodump-ng session in seconds
SLEEP_BETWEEN=2    # Wait time between sessions

# Ensure the interface is in monitor mode (adjust as needed)
echo "Putting interface $INTERFACE into monitor mode..."
ifconfig $INTERFACE down
iwconfig $INTERFACE mode monitor
ifconfig $INTERFACE up

# Run airodump-ng for the first session
echo "Starting airodump-ng for $DURATION seconds (session 1)..."
airodump-ng --write-interval 1 --output-format csv --write $OUTPUT_FILE_BASE_1 $INTERFACE &

# Capture PID and wait
PID=$!
sleep $DURATION
kill $PID 2>/dev/null || pkill airodump-ng

# Wait between sessions
echo "Waiting for $SLEEP_BETWEEN seconds..."
sleep $SLEEP_BETWEEN

# Run airodump-ng for the second session
echo "Starting airodump-ng for $DURATION seconds (session 2)..."
airodump-ng --write-interval 1 --output-format csv --write $OUTPUT_FILE_BASE_2 $INTERFACE &

# Capture PID and wait
PID=$!
sleep $DURATION
kill $PID 2>/dev/null || pkill airodump-ng

# Output completion message
echo "Data collection completed."
echo "Outputs saved as:"
echo " - ${OUTPUT_FILE_BASE_1}-01.csv"
echo " - ${OUTPUT_FILE_BASE_2}-01.csv"

# Restore interface to managed mode
echo "Restoring interface $INTERFACE to managed mode..."
ifconfig $INTERFACE down
iwconfig $INTERFACE mode managed
ifconfig $INTERFACE up
